"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _css=_interopRequireDefault(require("css")),_cleanCss=_interopRequireDefault(require("clean-css")),_matchMedia=_interopRequireDefault(require("./matchMedia"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var splitByMediaQuery=function(a){var b=a.cssFile,c=a.mediaOptions,d=a.minify,e={},f=_css.default.parse(b).stylesheet.rules,g={common:[]};return Object.keys(c).forEach(function(a){g[a]=[]}),f.forEach(function(a,b){var d=a.type,e=a.media,h=(0,_matchMedia.default)({mediaQuery:e,mediaOptions:c}),i=f[b],j=Object.values(h).every(function(a){return!a});"media"!==d||j?g.common.push(i):Object.keys(h).forEach(function(a){var b=h[a];b&&g[a].push(i)})}),Object.keys(g).forEach(function(a){e[a]=[];var b=g[a];b.forEach(function(b){var c=b.media,d=b.rules,f=e[a].map(function(a){var b=a.media;return b}).indexOf(c);!c||0>f?e[a].push(b):e[a][f].rules=e[a][f].rules.concat(d)});var c=_css.default.stringify({type:"stylesheet",stylesheet:{rules:e[a]}});e[a]=d?new _cleanCss.default().minify(c).styles:c}),e},_default=splitByMediaQuery;exports.default=_default;